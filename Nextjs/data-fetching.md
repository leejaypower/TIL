## Next.js의 데이터 패칭
- React App에서의 데이터 페칭은 기본적으로 컴포넌트 마운트 시점에 페칭을 진행한다. 
```tsx
useEffect(() => {
    fetch('https://jsonplaceholder.typicode.com/posts')
    .then(res => res.json())
    .then(data => {
        console.log(data)
    })
    }. [])
```
- CSR 특성상 FCP도달이 상대적으로 느린데, 패칭까지 렌더링이 된 이후에 진행되니 추가적인 시간이 더 소요되므로 사용자 경험에 좋지 않음

### Next App의 데이터 페칭은 사전 렌더링 중 발생이 가능하기 때문에 **데이터 요청 시점이 매우 빨라지는** 장점이 있다.

- 클라이언트가 첫 접속 요청을 하게 되면 `애플리케이션 서버(백엔드 서버)`에게 데이터를 요청하고, 응답을 받은 것을 토대로 `웹서버`가 JS 실행 및 렌더링을 하게 된다.

- 🤔 이와 같다면, 백엔드 서버의 상태가 안좋다면? 사용자는 아예 첫 HTML을 받지 못하게 되는 것일까?
- Next.js는 이런 사전 렌더링이 오래 걸릴 것 같은 페이지라면 **빌드 타임(`npm run build`)** 에 미리 사전 렌더링을 맞춰놓는 등의 다양한 사전 렌더링 방식을 제공한다. 

### Next.js의 사전 렌더링 방식은 다음과 같다.
1. **서버 사이드 렌더링 (SSR)**
 - 요청이 들어올 때 마다 사전 렌더링 진행
 - 백엔드 서버로의 요청이 필요로 하는 페이지라면 사전 렌더링 과정에서 백엔드 서버로 요청 - 항상 최신 상태로 유지 가능
 - 서버나 네트워크 이슈로 응답 속도가 너무 늦어지게 된다면 브라우저 로딩을 기다려야함

2. **정적 사이트 생성 (SSG - Static Site Generation)**
 - 빌드 타임에 미리 페이지를 사전 렌더링 해둠
 - 백엔드 서버에게 요청하는 경우, 그 과정이 매우 오래걸리게 되더라도 사용자 경험에는 영향이 없음!
 - 그리고 빌드 타임은 서버가 가동되는 시점에 진행되기 때문에 빌드 타임 이후 요청하는 페이지는 바로 응답할 수 있게 됨
 - 빌드타임 이후 페이지를 새롭게 생성하지 않기 때문에 요청을 여러번 해도 똑같은 페이지만 응답함 -> **최신 데이터 반영은 어렵다**
 - 데이터가 자주 바뀌지 않는 정적인 페이지들에 사용하기 좋다.

3. **증분 정적 사이트 생성 (ISR)**

### SSR vs CSR
- **사용자와의 빠른 상호 작용이 필요한 기능**에서는 CSR로 처리하는게 더 낫다! (검색 기능 등)
- SSR은 매 요청마다 서버에서 새로운 페이지를 생성하여 전송함
  - 서버 부하가 증가함
  - 매번 전체 페이지를 다시 로드해야 해서 사용자 경험이 저하됨
  - 네트워크 지연이 발생할 수 있음
- CSR은 초기 로드 후에는 브라우저에서 즉각적인 UI 업데이트 가능
  - 서버 왕복 없이 클라이언트에서 바로 데이터 처리 가능
  - 부드러운 사용자 경험 제공
  - 서버 부하 감소
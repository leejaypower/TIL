# 문자열

새로운 맥락에서 문자열의 의미를 파악해보자.

```
string s = "Hi!";
```

|  H   |  i   |  !   |  \0  |
| :--: | :--: | :--: | :--: |
| s[0] | s[1] | s[2] | s[3] |

- 문자열은 문자의 배열이고, 마지막의 \0은 문자열의 종료를 표시하는 약속이다.(널 종단 문자)
- s는 문자열이 시작하는 첫 번째 문자의 주소만 알고 있다.
- 컴퓨터는 문자열의 첫 번째 글자만 가리키면 널 종단 문자를 마주칠 떄까지 루프를 돌면서 끝을 알아낸다.
- 따라서 s가 여러개의 문자 중 첫 번째 문자의 주소를 저장하면 결국 그게 문자열이 된다.

- 즉 변수 s는 그 문자열을 가리키는 포인터가 된다.

<br>

cs50 라이브러리의 string 자료형은 실제로 다음과 같이 정의되어 있다.

```c
typedef char *string
```

- typedef는 새로운 자료형의 선언이다.

- char \*는 이 값의 형태가 문자의 주소가 될 것이라는 의미이다.
- 즉 char \*는 문자에 대한 포인터이다.
- string은 자료형의 이름이다.
- 그리고 string은 어떤 char 하나(문자열의 첫 번째 글자)를 가리키는 주소를 가지고 있는 변수가 된다.

> string이라는 새로운 자료형을 만드는데 이는 사실 char \*와 동일하다.<br> 이 것은 일종의 추상화이다. 문자의 나열을 결국에는 주소 하나로 나타낼 수 있다는 사실을 단순화 시킨 것이다.

<br>

### cs50의 string 자료형을 이용하여 출력

```c
#include <cs50.h>
#include <stdio.h>

int main(void)
{
    string s = "hello, world";
    printf("%s\n", s);
}
```

### char 포인터를 이용하여 출력

```c
#include <stdio.h>

int main(void)
{
    char *s = "hello, world";
    printf("%s\n", s);

    // 아래의 코드는 같은 결과를 출력한다.
    printf("%p\n", s);
    printf("%p\n", &s[0]);
}
```

> 문자열은 여러 문자의 묶음을 추상화한 것이다.

<br>

### 문자열의 비교

서로 다른 문자열을 단순히 동등연산자로 비교하게 되었을 때 결과는 어떻게 될까?

```C
#include <cs50.h>
#include <stdio.h>

int main(void)
{
    // 사용자로부터 s와 t 두 개의 문자열 입력받아 저장
    string s = get_string("s: ");
    string t = get_string("t: ");

    // 두 문자열을 비교 (각 문자들을 비교)
    if (s == t)
    {
        printf("Same\n");
    }
    else
    {
        printf("Different\n");
    }
}
```

```
Different
```

- string타입의 변수 s와 t에 사용자가 동일한 내용을 입력한 경우에도 결과는 <i>Different</i> 가 나온다.
- 같은 내용이라도 같은 곳에 있다는 의미는 아니다.
- 두 변수의 메모리 주소를 비교하게 된다.
- get_string을 호출할 때마다 사용자가 입력한 문자 크기만큼의 메모리를 확보 후 값을 저장한다.
- get_string의 반환값은 문자열 첫 문자의 주소이다.
- 즉 두 string 타입의 변수는 서로 다른 포인터이기 때문에 Different가 출력된다.

<br>

따라서 문자열의 내용을 비교하려면 포인터(\*)를 사용하여 조건문을 작성해야 한다.

<br>

### 문자열의 복사

```c
string s = get_string("s: ");
string t = s;
```

- 이 경우에는 변수 s에 메모리 주소가 저장되어 있다.
- string s는 char \*s 와 동일한 의미이다.
- 따라서 t도 s와 동일한 주소를 가리키고 있다.

서로 다른 메모리 공간에 같은 문자열을 복사하려면 어떻게 해야 할까?

C에는 <b>malloc</b>이라는 <b>메모리 할당 함수</b>가 있다.<br>
인자로 받는 것은 <b>할당받을 메모리 크기이다.</b>

```c
#include <cs50.h>
#include <ctype.h>
#include <stdio.h>
#include <string.h>

int main(void)
{
    char *s = get_string("s: ");
    char *t = malloc(strlen(s) + 1);
    // 널 종단 문자를 위해 받은 문자열의 길이에 1을 더한다.

    for (int i = 0, n = strlen(s); i < n + 1; i++)
    // 널 종단 문자까지 반복하기 위해 문자열의 길이에 1를 더한다.
    {
        t[i] = s[i];
        // 반복을 돌면서 s문자열의 내용물을 t문자열에 대입한다.
    }

    t[0] = toupper(t[0]);
    // 다른 주소(메모리)에 복사가 잘 되었는지 확인하기 위해 대문자로 변환해본다.

    printf("s: %s\n", s);
    printf("t: %s\n", t);

    free(t);
    // 메모리를 해제해주는 함수
}
```

<i>메모리를 할당했으면 메모리를 [free 함수](https://github.com/leejaypower/TIL/blob/main/CS50/메모리/메모리할당과해제.md)를 통해 메모리를 해제해주어야 한다.</i>

<br>

for문을 쓰지 않고도 복사해주는 함수도 존재한다.

```c
strcpy(t,s)
// t에 s의 내용을 복사하는 함수
```

<br>
<hr>
<a href="https://www.boostcourse.org/cs112">모두를 위한 컴퓨터과학(CS50 2019)</a> - 메모리/문자열, 문자열비교, 문자열복사로 공부한 내용입니다.

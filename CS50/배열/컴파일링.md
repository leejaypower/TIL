# 컴파일링

stdio.h는 헤더파일로, C언어로 작성되어 있으며 파일명이 .h로 끝난다.

이 파일에는 printf 함수의 프로토타입이 있어서, Clang 컴파일러가 프로그램을 컴파일할 때 printf가 무엇인지 알려주는 역할을 한다.

<br>

### 코드를 컴파일하고 프로그램을 실행하는 과정

```
clang -hello.c
./a.out
```

혹은

```
clang -o hello hello.c
./hello
```

<br>

cs50.h 라이브러리를 사용한 프로그램을 컴파일 할 때는 -lcs50을 붙여줘야 했다.

```
clang -o hello hello.c -lcs50
./hello
```

이는 clang에게 cs50 라이브러리에 있는 모든 0과 1들을 여기에 연결(link)하라는 의미이다.

> 컴파일링은 우리가 해온 것들을 사실 우리가 지금까지 해온 것들을 아주 간단하게 표현한 말이다.

<br>

make나 clang을 사용해서 프로그램을 실행할 때
이와 같은 4단계를 거친다.

### 1. preprocessing(전처리)

```c
#include <cs50.h>
#include <stdio.h>
```

> #으로 시작되는 C소스 코드는 전처리기에게 실질적인 컴파일이 이루어지기 전에 무언가를 실행하라고 알려준다.

- 이 두줄은 해당 파일의 실제 코드로 대체 된다.
- clang이 cs50.h파일에 직접 들어가 해당되는 코드를 가져와서 hello.c라는 파일에 붙여넣는 것이다.

  <br>

### 2. compiling(컴파일)

- 컴파일은 소스코드를 머신코드로 바꾸는 단계를 말하는데, 더 구체적인 단계를 뜻하기도 한다.
- 프로그램이 컴파일 될 때 전처리 과정을 거치고 <b>어셈블리 코드</b>로 바뀐다.
- 컴퓨터의 뇌인 CPU가 실제로 이해할 수 있는 언어에 가까워진다.

<br>

### 3. assembling(어셈블)

- clang이 어셈블리 코드를 0과 1로 이루어진 머신 코드로 바꾼다.

> 소스코드에서 머신코드로 컴파일 되어야 할 파일이 딱 한개라면, 컴파일 작업은 여기서 끝이 난다.

<br>

### 4. linking(링크)

> 프로그램이 여러 개의 파일로 이루어져 있는 경우 링크라는 컴파일의 마지막 단계가 필요하다.

- 위의 세 단계를 거친 여러개의 머신코드 파일을 하나의 큰 머신코드 파일로 합친다.

<br>

이 과정들이 끝나고 나면 최종적으로 실행 가능한 파일이 완성된다.

<br>
<hr>
<a href="https://www.boostcourse.org/cs112">모두를 위한 컴퓨터과학(CS50 2019)</a> - 컴파일링으로 공부한 내용입니다.
